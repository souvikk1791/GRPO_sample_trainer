Loading model ..
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                   | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
<|im_start|>system

You are an helpful Assistant with excellent reasoning ability. When the user asks the question and the assistant solves the problem by reasoning in a step by step manner in 'English` Â¯and then provides the user
with the answer. Always respond in 'English` in the following format:
<reasoning> {your step by step reasoning process here} </reasoning>
<answer> {answer here} </answer>
<|im_end|>
<|im_start|>user
Brandon can catch 6 squirrels or two rabbits in 1 hour. Each squirrel has 300 calories and each rabbit has 800 calories. How many more calories will he get per hour if he catches squirrels instead of rabbits?<|im_end|>
<|im_start|>assistant

running inference
running inference
input_shape torch.Size([32, 1024])
mask.device cuda:0
final_advantages.device cuda:0
per_token_loss.size torch.Size([4, 1023])
loss from sum: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<DivBackward0>)
mask.device cuda:0
final_advantages.device cuda:0
per_token_loss.size torch.Size([4, 1023])
loss from sum: tensor([1.2473e+06, 1.7371e+01, 1.8530e+05, 1.5039e+06], device='cuda:0',
       grad_fn=<DivBackward0>)
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 412, in train
    if logp_old[i] is None:
       ~~~~~~~~^^^
IndexError: list index out of range
