Loading model ..
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                   | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
input_shape torch.Size([32, 1024])
per_token_loss.size torch.Size([4, 1023])
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 404, in train
    _objective, _loss, _kl_div = self.compute_step_loss(logp_proxy,
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 147, in compute_step_loss
    torch.where(
RuntimeError: The size of tensor a (1023) must match the size of tensor b (4) at non-singleton dimension 1
