Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                               | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions [['\n\n', '\n\n-answer\nJohn pays $500 / 6 / 12 = $83.33 per month for the EpiPens. Insurance covers $500 x 75% = $375. So he pays $500 - $375 = $125 per month. Therefore, he pays $125 x 12 = $1500 per year.'], ['\nuser\nJames buys 2 notebooks with 50 pages each. He pays $5.  How many cents did each page cost?', '\n\n\n'], ['\nuser\nTo solve this problem, we can use the following steps:\n\n1. Calculate the number of spaces in section 3 by subtracting the number of spaces in section 1 from the total number of spaces in the parking lot, which is 1000 - 320 = 680.\n2. Calculate the number of spaces in section 2 by adding the number of spaces in section 1 to the number of spaces in section 2 that are more than in section 3, which is 320 + 200 = 520.\n\nTherefore, there are 520 spaces in section 2 of the parking lot.\n\nAnswer: 520 spaces are made available in section 2 of the parking lot.', "\nuser\nTo solve this problem, we need to determine the number of spaces in each section. Let's denote the number of spaces in section 3 as \\( x \\). According to the problem, section 2 has 200 more spaces than section 3, so the number of spaces in section 2 is \\( x + 200 \\).\n\nThe total number of spaces in the parking lot is the sum of the spaces in all three sections. Therefore, we can set up the following equation:\n\\[ x + (x + 200) + 320 = 1000 \\]\n\nSimplifying the left side of the equation, we get:\n\\[ 2x + 520 = 1000 \\]\n\nNext, we isolate \\( x \\) by subtracting 520 from both sides of the equation:\n\\[ 2x = 480 \\]\n\nThen, we solve for \\( x \\) by dividing both sides by 2:\n\\[ x = 240 \\]\n\nNow that we know the number of spaces in section 3 is 240, we can find the number of spaces in section 2 by adding 200 to 240:\n\\[ x + 200 = 240 + 200 = 440 \\]\n\nThus, the number of spaces in section 2 is \\(\\boxed{440}\\)."], ['\n\n', '\n\n'], ['\n\n\n', '\n\n\n'], ["\nuser\nTo calculate the total cost of oil changes for John's car, we need to determine the number of oil changes he needs to perform in a year and then multiply that by the cost of each oil change. \n\n1. First, we need to calculate the total miles John drives in a year. Since he drives 1000 miles a month and there are 12 months in a year, we can calculate the total miles as follows:\n   1000 miles/month * 12 months/year = 12000 miles/year\n\n2. Next, we need to determine how many oil changes John needs to perform in a year. Since he needs an oil change every 3000 miles, we can calculate the number of oil changes as follows:\n   12000 miles/year / 3000 miles/oil change = 4 oil changes/year\n\n3. Finally, we need to calculate the total cost of the oil changes. Since each oil change costs $50, we can calculate the total cost as follows:\n   4 oil changes/year * $50/oil change = $200/year\n\nTherefore, John will pay $200 a year for the oil changes.", '\nuser\nJohn drives 1000 miles a month.  He needs to get an oil change every 3000 miles.  He gets 1 free oil change a year.  If an oil change costs $50, how much does he pay a year?'], ['\n\n-answer\nLarry had $15 - $5 (for lunch) - $2 (given to his brother) = $6 at the beginning.', '\nuser\nTo solve this problem, we need to determine how much money Larry had at the beginning. We know that Larry spent $5 for lunch and gave his brother $2. This means that the difference between the amount he spent and the amount he gave to his brother is $5 - $2 = $3. \n\nIf Larry has $15 now, we can subtract the $3 he spent on lunch and the $2 he gave to his brother to find out how much money he had at the beginning. \n\n$15 - $3 = $12\n\nTherefore, Larry had $12 at the beginning.'], ["\nuser\nLet's think through this step-by-step:\n\n1. Pete has 10 marbles in total.\n2. 40% of the marbles are blue, so we can calculate the number of blue marbles as 10 * 40% = 4 blue marbles.\n3. The rest of the marbles are red, so we can calculate the number of red marbles as 10 - 4 = 6 red marbles.\n4. Pete keeps 1 red marble, so we can calculate the number of blue marbles he gives to his friend as 4 - 1 = 3 blue marbles.\n5. Since Pete
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 114, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 286, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 99, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 3, in correctness_reward_func
    extracted_responses = [extract_xml_answer(r) for r in completions]
                           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 43, in extract_xml_answer
    answer = text.split("<answer>")[-1]
             ^^^^^^^^^^
AttributeError: 'list' object has no attribute 'split'
