Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                                                                                                                                     | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ['涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n'
 '涞\n涞\n\nHeath planted 400 rows of carrots with 300 plants in each row, so he planted a total of 400 x 300 = 120,000 carrots.\nHe used a machine to get the planting done, so he took 20 hours to plant all the carrots.\nTo find out how many carrots he planted each hour, we divide the total number of carrots by the number of hours: 120,000 carrots / 20 hours = 6,000 carrots per hour.\nTherefore, Heath planted 6,000 carrots each hour.\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n'
 ' Comey\n Comey'
 ' Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his 2 siblings who are just as fast as him. How long does he work in hours? Comey system\n\nJames works on chores around the house. He has 3 bedrooms, 1 living room, and 2 bathrooms to clean. Each bedroom takes 20 minutes to clean. The living room takes as long as the 3 bedrooms combined. The bathroom takes twice as long as the living room. He also cleans the outside which takes twice as long as cleaning the house. He splits the chores with his ']
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 288, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 96, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 48, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 4, in correctness_reward_func
    return [2.0 if r == a else 0.0 for r, a in zip(extracted_responses, answer)]
                                                                        ^^^^^^
NameError: name 'answer' is not defined
