Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                                                                                                                                     | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ['\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', "\nuser\nReasoning: First, calculate the cost of replanting the rose bushes. The cost per rose bush is $150, and Bob has 20 rose bushes, so the total cost for the rose bushes is 20 * $150 = $3000. Next, calculate the cost of the gardener's services. The gardener charges $30 per hour, and they work 5 hours each day for 4 days, so the total cost for the gardener is 5 * $30 * 4 = $600. Then, calculate the cost of the soil. The soil is sold for $5 per cubic foot, and Bob needs 100 cubic feet, so the total cost for the soil is 100 * $5 = $500. Finally, add up all the costs to find the total cost of the gardening project. The total cost is $3000 + $600 + $500 = $4100. Answer: $4100.", "\nuser\n<reasoning> First, we need to find the total cost of the rose bushes. Since each rose bush costs $150 and there are 20 rose bushes, the total cost is 20 * $150 = $3000. Next, we need to calculate the cost of the gardener's labor. The gardener charges $30 per hour and works for 5 hours each day for 4 days, so the total cost is 30 * 5 * 4 = $600. Then, we need to calculate the cost of the soil. The soil costs $5 per cubic foot and the garden has 100 cubic feet, so the total cost is 5 * 100 = $500. Finally, we add up all the costs to find the total cost of the gardening project: $3000 + $600 + $500 = $4100. </reasoning>\n<answer> $4100 </answer>", '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n', '\n\n\n']
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 283, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 96, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 5, in correctness_reward_func
    return [2.0 if r == a else 0.0 for r, a in zip(extracted_responses, answer)]
                                                                        ^^^^^^
NameError: name 'answer' is not defined
