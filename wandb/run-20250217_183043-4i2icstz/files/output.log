Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                               | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ['system\n\nRespond in the following format:\n<reasoning>\n...\n</reasoning>\n<answer>\n...\n</answer>\n\nuser\nJohn ends up serving on jury duty.  Jury selection takes 2 days.  The trial itself lasts 4 times as long as jury selection  It is a complicated trial.  The number of hours spent in jury deliberation was the equivalent of 6 full days.  They spend 16 hours a day in deliberation.  How many days does John spend on jury duty?\n\nuser\nTo solve this problem, we need to calculate the total time spent on jury duty and divide it by the number of days available for jury duty.\nTo do this, we need to calculate the total time spent on jury duty, which is the sum of the time spent on jury selection, the trial itself, and the jury deliberation time. We can do this by adding the time spent on jury selection, the trial itself, and the number of hours spent in jury deliberation.\nThe time spent on jury selection is 2 days.\nThe trial itself lasts 4 times as long as jury selection, so it lasts 2 * 4 = 8 days.\nThe number of hours spent in jury deliberation is 16 hours a day, so it lasts 16 * 6 = 96 hours.\nNow we can calculate the total time spent on jury duty by adding these values together: 2 + 8 + 96 = 106 days.\nTo find the number of days John spends on jury duty, we divide the total time by the number of days available for jury duty: 106 / 10 = 10.6 days.\nTherefore, John spends 10.6 days on jury duty.', 'system\n\nRespond in the following format:\n<reasoning>\n...\n</reasoning>\n<answer>\n...\n</answer>\n\nuser\nJohn ends up serving on jury duty.  Jury selection takes 2 days.  The trial itself lasts 4 times as long as jury selection  It is a complicated trial.  The number of hours spent in jury deliberation was the equivalent of 6 full days.  They spend 16 hours a day in deliberation.  How many days does John spend on jury duty?\n\nuser\nLet x be the number of days John spends on jury duty. \nJury selection takes 2 days\nThe trial lasts 4 times as long as jury selection, so 4*2 = 8 days\nThe deliberation is equivalent to 6 full days, so 6 days\nThey spend 16 hours a day in deliberation, so 16*16 = 256 hours\nThe total number of days is the sum of the days spent on jury duty, jury selection, trial, and deliberation, which is 2 + 4 + 6 + 16 = 28 days\n\nTherefore, the answer is 28.', "system\n\nRespond in the following format:\n<reasoning>\n...\n</reasoning>\n<answer>\n...\n</answer>\n\nuser\nJordan noticed that there are 2 cars in his driveway that each have 4 wheels.  There are 2 bikes and a trash can that each have 2 wheels.  There is also a tricycle and a pair of old roller skates.  How many wheels are there?\n\nuser\nTo solve this problem, we need to calculate the total number of wheels for each type of vehicle and then sum them up. Let's break it down:\n\n1. Cars: There are 2 cars, and each car has 4 wheels. So, the total number of wheels for the cars is 2 * 4 = 8 wheels.\n\n2. Bikes: There are 2 bikes, and each bike has 2 wheels. So, the total number of wheels for the bikes is 2 * 2 = 4 wheels.\n\n3. Trash can: There is 1 trash can, and it has 2 wheels. So, the total number of wheels for the trash can is 1 * 2 = 2 wheels.\n\n4. Tricycle: There is 1 tricycle, and it has 3 wheels. So, the total number of wheels for the tricycle is 1 * 3 = 3 wheels.\n\n5. Roller skates: There are 2 pairs of roller skates, and each pair has 4 wheels. So, the total number of wheels for the roller skates is 2 * 4 = 8 wheels.\n\nNow, we sum up all the wheels:\n\n8 (cars) + 4 (bikes) + 2 (trash can) + 3 (tricycle) + 8 (roller skates) = 25 wheels.\n\nTherefore, there are 25 wheels in total.", 'system\n\nRespond in the following format:\n<reasoning>\n...\n</reasoning>\n<answer>\n...\n</answer>\n\nuser\nJordan noticed that there are 2 cars in his driveway that each have 4 wheels.  There are 2 bikes and a trash can that each have 2 wheels.  There is also a tricycle and a pair of old roller skates.  How many wheels are there?\n\nuser\nTo find the total number of wheels, we need to multiply the number of each type of vehicle by the numb
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 114, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 286, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 99, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 5, in correctness_reward_func
    return [2.0 if r == a else 0.0 for r, a in zip(extracted_responses, answer)]
                                                                        ^^^^^^
NameError: name 'answer' is not defined
