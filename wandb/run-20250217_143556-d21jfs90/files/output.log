Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                               | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ["\nuser\nTo determine how many dollars remain in Emma's bank account, we need to follow these steps:\n\n1. Calculate the total amount spent by Emma each day of the week.\n2. Determine the total amount spent over the entire week.\n3. Subtract the total amount spent from the initial amount in the bank account to find the remaining balance.\n\nFirst, let's calculate the total amount spent by Emma each day of the week. Emma spends $8 each day, and there are 7 days in a week. So, the total amount spent each day is:\n\\[ 8 \\text{ dollars/day} \\times 7 \\text{ days/week} = 56 \\text{ dollars/week} \\]\n\nNext, we need to find out how much money Emma spends in total over the entire week. Since she spends $56 each day, over 7 days she spends:\n\\[ 56 \\text{ dollars/day} \\times 7 \\text{ days/week} = 392 \\text{ dollars/week} \\]\n\nEmma's initial amount in the bank account is $100. After spending $392 over the week, the amount of money remaining in the account is:\n\\[ 100 \\text{ dollars} - 392 \\text{ dollars} = -292 \\text{ dollars} \\]\n\nSince the amount remaining in the account is negative, it means Emma does not have enough money to cover the total amount she spends. Therefore, the amount of money that remains in the account is:\n\\[ \\boxed{0} \\]", '\n\n\n', '\n\n\n', '\nuser\nTo find out how much one chair cost, we need to subtract the cost of the table from the total amount spent. Then, we divide the remaining amount by the number of chairs to find the cost of one chair.\nReasoning:\n1. Nadine spent $56 in total.\n2. She bought a table for $34.\n3. The remaining amount spent on chairs is $56 - $34 = $22.\n4. She bought 2 chairs.\n5. To find the cost of one chair, we divide the remaining amount by the number of chairs: $22 / 2 = $11.\nAnswer:\nOne chair cost $11.', '\nuser\nTo calculate the total amount Fern pays, we first need to determine the price of one pair of ballet slippers. Since the ballet slippers cost 2/3 of the price of the high heels, we can calculate this as follows:\n\nPrice of one pair of ballet slippers = 2/3 * $60 = $40\n\nNow, we can calculate the total amount Fern pays by adding the price of the high heels and the price of the ballet slippers:\n\nTotal amount = Price of high heels + Price of ballet slippers\nTotal amount = $60 + $40 = $100\n\nTherefore, Fern pays a total of $100 for the purchase.', "\nuser\nFirst, let's calculate how much rope Bob uses to make the small piece of art. Since he uses a 5th of the 50 feet, he uses 50/5 = 10 feet. \n\nNext, we subtract the rope used for the art from the total to find out how much rope is left for the friend. This is 50 - 10 = 40 feet.\n\nThen, Bob gives half of the remaining rope to his friend. So, he gives away 40/2 = 20 feet.\n\nFinally, we subtract the rope given away from the remaining rope to find out how much rope is left for Bob to cut into sections. This is 40 - 20 = 20 feet.\n\nNow, Bob can cut 20/2 = 10 sections of 2-foot rope each.\n\nSo, Bob gets 10 sections of rope.", '\n\n\n', '\n\n\n', '\nuser\nElizabeth has 10 reusable water bottles. She loses 2 water bottles at school. Then someone steals 1 of her water bottles at dance practice. To avoid any future theft of her water bottles, Elizabeth places 3 stickers on each of her remaining bottles. How many stickers does Elizabeth use in total on her water bottles?', "\nuser\nBilly's mom sends him to get ketchup. She gives him $10 and tells him to get the best deal on ketchup that he can and to spend all $10 on ketchup. He finds a bottle with 10 oz that cost $1 each. He finds a bottle that costs $2 that contains 16 ounces. He finds a bottle with 25 ounces that costs $2.5. He finds a $5 bottle that contains 50 ounces. Finally, he finds a $10 bottle with 200 ounces. How many bottles of ketchup does he buy?", "\nuser\nAndrew's mother wants to buy the same amount of donuts for Andrew as everybody else. Andrew is going to buy 3 donuts for himself. How many donuts will Andrewâ€™s mother need to buy?", '\n\n\n', '\n\n', "\nuser\nTo calculate Steve's take-home pay, we need to subtract his exp
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 114, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 289, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 99, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 3, in correctness_reward_func
    extracted_responses = [extract_xml_answer(r) for r in completions]
                           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 43, in extract_xml_answer
    answer = text.split("<answer>")[-1]
             ^^^^^^^^^^
AttributeError: 'list' object has no attribute 'split'
