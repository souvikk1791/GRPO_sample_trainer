Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                                                                                                                                     | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ['涞\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞', '涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞\n涞', '涞\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n涞\n\n
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 287, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 96, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 5, in correctness_reward_func
    return [2.0 if r == a else 0.0 for r, a in zip(extracted_responses, answer)]
                                                                        ^^^^^^
NameError: name 'answer' is not defined
