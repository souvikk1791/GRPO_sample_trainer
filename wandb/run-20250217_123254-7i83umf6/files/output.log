Loading model ..
tokenizer_config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 7.30k/7.30k [00:00<00:00, 58.8MB/s]
vocab.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 2.78M/2.78M [00:00<00:00, 30.7MB/s]
merges.txt: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1.67M/1.67M [00:00<00:00, 25.1MB/s]
tokenizer.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 7.03M/7.03M [00:00<00:00, 14.1MB/s]
get peft model
Creating reference model
Traceback (most recent call last):
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 113, in <module>
    trainer.init_model(model_name, get_peft=True)
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 160, in init_model
    for param in reference_model.parameters():
                 ^^^^^^^^^^^^^^^
NameError: name 'reference_model' is not defined. Did you mean: 'self.reference_model'?
