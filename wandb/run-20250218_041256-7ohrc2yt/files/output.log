Loading model ..
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
get peft model
Creating reference model
start training
GRPO Training:   0%|                                                                                                                                                                                                                                                     | 0/4680 [00:00<?, ?it/s]Traceback (most recent call last):
running inference
running inference
completions ['system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process and answer are enclosed within <reasoning> </reasoning> and\n<answer> </answer> tags, respectively, i.e., <reasoning> reasoning process here </reasoning>\n<answer> answer here </answer>\n\nuser\nJosiah is three times as old as Hans. Hans is 15 years old now. In three years, what is the sum of the ages of Josiah and Hans?\n\n\n\n', 'system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process and answer are enclosed within <reasoning> </reasoning> and\n<answer> </answer> tags, respectively, i.e., <reasoning> reasoning process here </reasoning>\n<answer> answer here </answer>\n\nuser\nJosiah is three times as old as Hans. Hans is 15 years old now. In three years, what is the sum of the ages of Josiah and Hans?\n\n\n\n', 'system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process and answer are enclosed within <reasoning> </reasoning> and\n<answer> </answer> tags, respectively, i.e., <reasoning> reasoning process here </reasoning>\n<answer> answer here </answer>\n\nuser\nThere are three dogs in the backyard. They like apples, blueberries, and bonnies. The first dog, which likes apples, eats 3 times as many apples as the number of blueberries eaten by the second dog that likes blueberries. The dog that likes blueberries eats 3/4 times as many blueberries as the number of bonnies eaten by the third dog. If the dog that likes bonnies ate 60 of them, calculate the total number of fruits eaten by the three dogs?\n\nuser\n<answer> 120 </answer>', 'system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process and answer are enclosed within <reasoning> </reasoning> and\n<answer> </answer> tags, respectively, i.e., <reasoning> reasoning process here </reasoning>\n<answer> answer here </answer>\n\nuser\nThere are three dogs in the backyard. They like apples, blueberries, and bonnies. The first dog, which likes apples, eats 3 times as many apples as the number of blueberries eaten by the second dog that likes blueberries. The dog that likes blueberries eats 3/4 times as many blueberries as the number of bonnies eaten by the third dog. If the dog that likes bonnies ate 60 of them, calculate the total number of fruits eaten by the three dogs?\n\nuser\n<reasoning>\nThe first dog eats 3 times as many apples as the number of blueberries eaten by the second dog, which is 3/4 times as many blueberries as the number of bonnies eaten by the third dog. The dog that likes bonnies ate 60 of them. So, the number of bonnies eaten by the third dog is 60/60 = 1. The number of blueberries eaten by the second dog is 3/4 * 1 = 0.75. The number of apples eaten by the first dog is 3 * 0.75 = 2.25. The total number of fruits eaten by the three dogs is 60 + 1 + 2.25 = 63.5. \n</reasoning>\n<answer>63.5</answer>', 'system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process and answer are enclosed within <reasoning> </reasoning> and\n<answer> </answer> tags, respectively, i.e., <reasoning> reasoning process here </reasoning>\n<answer> answer here </answer>\n\nuser\nCape May has 8 more than twice as many sharks as Daytona Beach. If Daytona Beach has 12 sharks, how many sharks are there in Cape May?\n\n\n\n', 'system\n\nThe user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user\nwith the answer. The reasoning process an
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/trainer.py", line 102, in <module>
    trainer.train(dataloader, save_directory="models/")
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 283, in train
    advantages, rewards, rewards_list = self.get_advantages(
                                        ^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/grpo.py", line 96, in get_advantages
    rewards, rewards_list = total_reward(completions, **kwargs)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 49, in total_reward
    correctness_reward_func(completions, **kwargs),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/vision training/GRPO_sample_trainer/utils.py", line 5, in correctness_reward_func
    return [2.0 if r == a else 0.0 for r, a in zip(extracted_responses, answer)]
                                                                        ^^^^^^
NameError: name 'answer' is not defined
